@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
@{
    var data = ViewData["images"] as IEnumerable<DomainLayer.ProductModel.Images>;
}
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@model DTOLayer.Product.ProductViewModel;
<style type="text/css">
		 .image_container {
		 	height: 120px;
		 	width: 200px;
		 	border-radius: 6px;
		 	overflow: hidden;
		 	margin: 10px;
		 }
		 .image_container {
    height: 359px;
    width: 393px;
    border-radius: 6px;
    overflow: hidden;
    margin: 10px;
}
}
		 #delete {
		 	top: -6px;
		 	right: 8px;
		 	color: red;
		 	font-size: 50px;
		 	font-weight: normal;
		 	cursor: pointer;
		 }
.position-absolute {
    position: absolute!important;
    font-size: 40px;
    color: red;
        margin-top: -20px;
}
	</style>
<form asp-action="AddImages" method="post" enctype="multipart/form-data">
    <div class="mb-3">
                <input asp-for="id" type="hidden" value="@Model.id">
                <label for="formFileMultiple" class="form-label">Uplaod product images</label>
                <input id="image" asp-for="imageFile" accept="image/*"   class="form-control" type="file" onchange="imageselect()" style="height: 45px;margin-top: 3px;">
                <div class="image-area mt-4" style="width: 100%;HEIGHT: 100%;padding: 0px;border: 1px inset;border-radius: 14px;height: 100%;"></div>
                <span  id="input-alert" class="text-danger"></span>
            </div>
            <div class="card-body d-flex flex-wrap justify-content-start" id="container">  	  
   	        </div>
               <input type="submit" value="add" class="btn btn-success col "/>
</form>
@*<partial name="partialViews/_ImagePreview" model="Model"/>*@
@*<table class="table">
@if(data == null){
        <h1>No iamges</h1>}
        else{ 
            foreach (var item in data){
                <div class="card" style="width : 250px; height:500px;">
                     <img src="~/Product/Images/@item.imagePath" width="250" height="500" />
                     <span id="delete" class="position-absolute" onclick="someFunction(@item.id) ">&times;</span>
                </div>
               
            } 
        }
    
</table>*@

<script>


   

    /*  ==========================================
        SHOW UPLOADED IMAGE NAME
    * ========================================== 
    var input = document.getElementById('upload');
    var infoArea = document.getElementById('upload-label');

    input.addEventListener('change', showFileName);
    function showFileName(event) {
        var input = event.srcElement;
        var fileName = input.files[0].name;
        infoArea.textContent = 'File name: ' + fileName;
    }
    $(document).ready(function(){
        $('input[name=imageFile]').change(function(){
            filesize();
        })
    })
  
   function filesize(){
       alert("clicked");
   }
   */
   // this variable will store images for preview
   var images = [];
   var image = [];

   function imageselect() {
       
   	  	  image = Array.from(document.getElementById('image').files);
   	  	  for (i = 0; i < image.length; i++) {
   	  	  	  if (check_duplicate(image[i].name)) {
                images.push({
   	  	  	  	    "name" : image[i].name,
   	  	  	  	    "url" : URL.createObjectURL(image[i]),
   	  	  	  	    "file" : image[i],
   	  	  	    })
   	  	  	  } else 
   	  	  	  {
   	  	  	  	 alert(image[i].name + " is already added to the list");
   	  	  	  }
   	  	  }
   	  	  document.getElementById('container').innerHTML = imageshow();
   	  }

         function imageshow() {
             
   	  	  var image = "";
   	  	  images.forEach((i) => {
   	  	  	 image += `<div class="image_container d-flex justify-content-center position-relative">
   	  	  	  	  <img src="`+ i.url +`" alt="Image">
   	  	  	  	  <span class="position-absolute" onclick="delete_image(`+ images.indexOf(i) +`)">&times;</span>
   	  	  	  </div>`;
   	  	  })
   	  	  return image;
   	  }
         function check_duplicate(name) {
   	  	var image = true;
   	  	if (images.length > 0) {
   	  		for (e = 0; e < images.length; e++) {
   	  			if (images[e].name == name) {
   	  				image = false;
   	  				break;
   	  			}
   	  		}
   	  	}
   	  	return image;
   	  }

                
    function delete_image(e) {
   	  	  images.splice(e, 1);
          
          image.splice(e,1);
   	  	  document.getElementById('container').innerHTML = imageshow();
          $('#image').val(image);
   	}
       function getFiles(){
           return image;
       }

</script>
